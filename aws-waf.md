# AWS WAF (Web Application Firewall)

## Má»¥c lá»¥c
- [Giá»›i thiá»‡u](#giá»›i-thiá»‡u)
- [Kiáº¿n trÃºc vÃ  thÃ nh pháº§n](#kiáº¿n-trÃºc-vÃ -thÃ nh-pháº§n)
- [Web ACL](#web-acl)
- [Rules vÃ  Rule Groups](#rules-vÃ -rule-groups)
- [Managed Rules](#managed-rules)
- [Bot Control](#bot-control)
- [Fraud Control](#fraud-control)
- [Integration vá»›i AWS Services](#integration-vá»›i-aws-services)
- [So sÃ¡nh WAF vs Shield vs Firewall Manager](#so-sÃ¡nh-waf-vs-shield-vs-firewall-manager)
- [Pricing](#pricing)
- [Best Practices](#best-practices)
- [Exam Tips](#exam-tips)

---

## Giá»›i thiá»‡u

**AWS WAF** lÃ  **Web Application Firewall** giÃºp báº£o vá»‡ á»©ng dá»¥ng web vÃ  API khá»i cÃ¡c **web exploits phá»• biáº¿n** nhÆ° SQL injection, XSS, vÃ  cÃ¡c bot Ä‘á»™c háº¡i.

### WAF báº£o vá»‡ khá»i nhá»¯ng gÃ¬?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AWS WAF Protection                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚   Attacker    â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚          â”‚                                                      â”‚
â”‚          â”‚ Malicious Requests:                                  â”‚
â”‚          â”‚ â€¢ SQL Injection: ' OR 1=1 --                         â”‚
â”‚          â”‚ â€¢ XSS: <script>alert('hack')</script>                â”‚
â”‚          â”‚ â€¢ Bad Bots: Scrapers, credential stuffing            â”‚
â”‚          â”‚ â€¢ DDoS: Layer 7 attacks                              â”‚
â”‚          â”‚ â€¢ Fraud: Fake account creation                       â”‚
â”‚          â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚              AWS WAF                       â”‚                  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚
â”‚  â”‚  â”‚           Web ACL                    â”‚  â”‚                  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”   â”‚  â”‚                  â”‚
â”‚  â”‚  â”‚  â”‚Rule1â”‚ â”‚Rule2â”‚ â”‚Rule3â”‚ â”‚Rule4â”‚   â”‚  â”‚                  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜   â”‚  â”‚                  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚
â”‚  â”‚                                           â”‚                  â”‚
â”‚  â”‚  âŒ BLOCK malicious requests              â”‚                  â”‚
â”‚  â”‚  âœ… ALLOW legitimate requests             â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚          â”‚                                                      â”‚
â”‚          â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  CloudFront / ALB / API Gateway / AppSync â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚          â”‚                                                      â”‚
â”‚          â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚         Your Application                   â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Äáº·c Ä‘iá»ƒm chÃ­nh

| Äáº·c Ä‘iá»ƒm | MÃ´ táº£ |
|----------|-------|
| **Layer** | Layer 7 (Application Layer) |
| **Managed Service** | Fully managed, khÃ´ng cáº§n quáº£n lÃ½ infrastructure |
| **Real-time** | Block requests ngay láº­p tá»©c |
| **Visibility** | CloudWatch metrics vÃ  logs |
| **Flexibility** | Custom rules + Managed rules |

---

## Kiáº¿n trÃºc vÃ  thÃ nh pháº§n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AWS WAF Architecture                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                        Web ACL                                  â”‚     â”‚
â”‚   â”‚                                                                 â”‚     â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚   â”‚   â”‚                    Rule Groups                           â”‚  â”‚     â”‚
â”‚   â”‚   â”‚                                                          â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  â”‚ AWS Managed      â”‚  â”‚ Your Custom      â”‚             â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  â”‚ Rule Groups      â”‚  â”‚ Rule Groups      â”‚             â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  â”‚                  â”‚  â”‚                  â”‚             â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  â”‚ â€¢ Core Rule Set  â”‚  â”‚ â€¢ IP whitelist   â”‚             â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  â”‚ â€¢ SQL injection  â”‚  â”‚ â€¢ Geo blocking   â”‚             â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  â”‚ â€¢ Bad inputs     â”‚  â”‚ â€¢ Rate limiting  â”‚             â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  â”‚ â€¢ Bot Control    â”‚  â”‚ â€¢ Custom logic   â”‚             â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚     â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚   â”‚                                                                 â”‚     â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚   â”‚   â”‚                   Individual Rules                       â”‚  â”‚     â”‚
â”‚   â”‚   â”‚                                                          â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  Rule 1 â”€â”€â–º Rule 2 â”€â”€â–º Rule 3 â”€â”€â–º ... â”€â”€â–º Default Action â”‚  â”‚     â”‚
â”‚   â”‚   â”‚                                                          â”‚  â”‚     â”‚
â”‚   â”‚   â”‚  ÄÃ¡nh giÃ¡ theo thá»© tá»± priority (sá»‘ nhá» = Æ°u tiÃªn cao)    â”‚  â”‚     â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚   â”‚                                                                 â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                     â”‚                                     â”‚
â”‚                    Associated vá»›i Resources                               â”‚
â”‚                                     â”‚                                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚         â”‚               â”‚           â”‚           â”‚               â”‚        â”‚
â”‚         â–¼               â–¼           â–¼           â–¼               â–¼        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚CloudFrontâ”‚   â”‚   ALB    â”‚ â”‚   API    â”‚ â”‚ AppSync  â”‚  â”‚ Cognito  â”‚   â”‚
â”‚   â”‚          â”‚   â”‚          â”‚ â”‚ Gateway  â”‚ â”‚          â”‚  â”‚          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CÃ¡c thÃ nh pháº§n chÃ­nh

| ThÃ nh pháº§n | MÃ´ táº£ |
|------------|-------|
| **Web ACL** | Container chÃ­nh chá»©a táº¥t cáº£ rules |
| **Rule** | Äiá»u kiá»‡n kiá»ƒm tra request |
| **Rule Group** | NhÃ³m nhiá»u rules láº¡i vá»›i nhau |
| **IP Set** | Danh sÃ¡ch IP addresses Ä‘á»ƒ allow/block |
| **Regex Pattern Set** | Patterns Ä‘á»ƒ match request content |

---

## Web ACL

**Web ACL (Web Access Control List)** lÃ  resource chÃ­nh trong AWS WAF, chá»©a cÃ¡c rules Ä‘á»ƒ inspect vÃ  quyáº¿t Ä‘á»‹nh action cho má»—i request.

### Actions

| Action | MÃ´ táº£ | Khi nÃ o dÃ¹ng |
|--------|-------|--------------|
| **ALLOW** | Cho phÃ©p request Ä‘i qua | Whitelist IPs, known good traffic |
| **BLOCK** | Cháº·n request, tráº£ vá» 403 | Malicious requests |
| **COUNT** | Äáº¿m nhÆ°ng khÃ´ng block | Testing rules trÆ°á»›c khi enforce |
| **CAPTCHA** | YÃªu cáº§u giáº£i CAPTCHA | Nghi ngá» bot |
| **Challenge** | JavaScript challenge | Silent bot detection |

### Web ACL Capacity Units (WCUs)

Má»—i rule tiÃªu thá»¥ má»™t lÆ°á»£ng **WCU** nháº¥t Ä‘á»‹nh. Web ACL cÃ³ giá»›i háº¡n **1,500 WCUs** máº·c Ä‘á»‹nh.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WCU Examples                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Rule Type                          â”‚ WCU Cost              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  IP Set match                       â”‚ 1 WCU                 â”‚
â”‚  Single string match                â”‚ 2 WCUs                â”‚
â”‚  Regex pattern set (up to 10)       â”‚ 25 WCUs               â”‚
â”‚  SQL injection detection            â”‚ 20 WCUs               â”‚
â”‚  XSS detection                      â”‚ 40 WCUs               â”‚
â”‚  Rate-based rule                    â”‚ 2 WCUs                â”‚
â”‚  AWS Managed Rule Groups            â”‚ Varies (25-700 WCUs)  â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ VÆ°á»£t quÃ¡ 1,500 WCUs â†’ tÃ­nh phÃ­ thÃªm $0.20/1M requests  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Rules vÃ  Rule Groups

### CÃ¡c loáº¡i Rules

#### 1. Regular Rules
Match dá»±a trÃªn conditions nhÆ° IP, headers, body, query string...

```yaml
# VÃ­ dá»¥: Block requests tá»« country cá»¥ thá»ƒ
Type: Regular Rule
Conditions:
  - GeoMatch: [CN, RU, KP]
Action: BLOCK
```

#### 2. Rate-based Rules
Block IP khi vÆ°á»£t quÃ¡ threshold requests trong khoáº£ng thá»i gian.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Rate-based Rule                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Threshold: 2000 requests / 5 minutes (per IP)              â”‚
â”‚                                                             â”‚
â”‚  IP: 203.0.113.50                                           â”‚
â”‚  â”œâ”€â”€ Request 1........Request 1999  â†’ âœ… ALLOW              â”‚
â”‚  â””â”€â”€ Request 2000+                  â†’ âŒ BLOCK (temporarily)â”‚
â”‚                                                             â”‚
â”‚  Use cases:                                                 â”‚
â”‚  â€¢ Brute force protection                                   â”‚
â”‚  â€¢ API abuse prevention                                     â”‚
â”‚  â€¢ DDoS mitigation                                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. Rule Groups

NhÃ³m nhiá»u rules láº¡i vá»›i nhau Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng.

| Loáº¡i | MÃ´ táº£ |
|------|-------|
| **AWS Managed** | Rules do AWS táº¡o vÃ  maintain |
| **AWS Marketplace** | Rules tá»« third-party vendors |
| **Your Own** | Custom rule groups báº¡n tá»± táº¡o |

---

## Managed Rules

**Managed Rules** lÃ  cÃ¡c rule groups Ä‘Æ°á»£c cáº¥u hÃ¬nh sáºµn, tá»± Ä‘á»™ng update bá»Ÿi AWS hoáº·c vendors.

### AWS Managed Rule Groups

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AWS Managed Rule Groups                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  BASELINE RULE GROUPS (KhuyÃªn dÃ¹ng cho má»i á»©ng dá»¥ng)             â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesCommonRuleSet (Core Rule Set - CRS)            â”‚   â”‚
â”‚  â”‚    â†’ OWASP Top 10, SQL injection, XSS, path traversal            â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesAdminProtectionRuleSet                         â”‚   â”‚
â”‚  â”‚    â†’ Block external access to admin pages                        â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesKnownBadInputsRuleSet                          â”‚   â”‚
â”‚  â”‚    â†’ Block known bad request patterns                            â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  USE-CASE SPECIFIC RULE GROUPS                                    â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesSQLiRuleSet         â†’ SQL injection protection â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesLinuxRuleSet        â†’ Linux-specific attacks   â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesUnixRuleSet         â†’ Unix-specific attacks    â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesWindowsRuleSet      â†’ Windows-specific attacks â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesPHPRuleSet          â†’ PHP-specific attacks     â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesWordPressRuleSet    â†’ WordPress vulnerabilitiesâ”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  IP REPUTATION RULE GROUPS                                        â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesAmazonIpReputationList                         â”‚   â”‚
â”‚  â”‚    â†’ Block known malicious IPs tá»« AWS threat intelligence        â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  â€¢ AWSManagedRulesAnonymousIpList                                â”‚   â”‚
â”‚  â”‚    â†’ Block traffic tá»« VPNs, Tor, proxies, hosting providers      â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Lá»±a chá»n Managed Rules

| á»¨ng dá»¥ng | Recommended Rule Groups |
|----------|------------------------|
| **Má»i web app** | Core Rule Set, Known Bad Inputs |
| **WordPress** | + WordPress Rule Set |
| **PHP app** | + PHP Rule Set |
| **Linux server** | + Linux Rule Set |
| **API** | + API Gateway optimized rules |
| **Admin panels** | + Admin Protection |

---

## Bot Control

**AWS WAF Bot Control** giÃºp phÃ¡t hiá»‡n vÃ  quáº£n lÃ½ bot traffic.

### Hai má»©c Ä‘á»™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Bot Control Levels                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  COMMON BOT CONTROL                                            â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â”‚  â€¢ PhÃ¡t hiá»‡n bots phá»• biáº¿n (scrapers, crawlers, bots tá»‘t)     â”‚      â”‚
â”‚  â”‚  â€¢ Categorize: Verified bots, Unverified bots, Good bots      â”‚      â”‚
â”‚  â”‚  â€¢ Fingerprinting dá»±a trÃªn request patterns                   â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â”‚  Cost: $1/million requests (10M free/month)                   â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  TARGETED BOT CONTROL                                          â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â”‚  â€¢ ML-based detection cho sophisticated bots                   â”‚      â”‚
â”‚  â”‚  â€¢ Behavioral analysis                                         â”‚      â”‚
â”‚  â”‚  â€¢ Browser fingerprinting                                      â”‚      â”‚
â”‚  â”‚  â€¢ JavaScript challenge interstitials                          â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â”‚  Cost: $10/million requests (1M free/month)                   â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Bot Categories

| Category | VÃ­ dá»¥ | Action thÆ°á»ng dÃ¹ng |
|----------|-------|-------------------|
| **Verified Bots** | Googlebot, Bingbot | ALLOW |
| **Unverified Bots** | Unknown crawlers | COUNT or BLOCK |
| **Good Bots** | Monitoring tools | ALLOW |
| **Bad Bots** | Scrapers, spammers | BLOCK |

---

## Fraud Control

**Fraud Control** báº£o vá»‡ login vÃ  signup pages khá»i cÃ¡c cuá»™c táº¥n cÃ´ng fraud.

### Hai features chÃ­nh

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Fraud Control Features                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ACCOUNT TAKEOVER PREVENTION (ATP)                             â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â”‚  Báº£o vá»‡ LOGIN pages khá»i:                                     â”‚      â”‚
â”‚  â”‚  â€¢ Credential stuffing (dÃ¹ng leaked passwords)                â”‚      â”‚
â”‚  â”‚  â€¢ Credential cracking (brute force)                          â”‚      â”‚
â”‚  â”‚  â€¢ Distributed attacks tá»« nhiá»u IPs                           â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â”‚  CÃ¡ch hoáº¡t Ä‘á»™ng:                                              â”‚      â”‚
â”‚  â”‚  1. Inspect login requests                                    â”‚      â”‚
â”‚  â”‚  2. Check credentials against stolen credential databases     â”‚      â”‚
â”‚  â”‚  3. Analyze login patterns (rate, success/failure)            â”‚      â”‚
â”‚  â”‚  4. Block suspicious attempts                                 â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ACCOUNT CREATION FRAUD PREVENTION (ACFP)                      â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â”‚  Báº£o vá»‡ SIGNUP pages khá»i:                                    â”‚      â”‚
â”‚  â”‚  â€¢ Automated fake account creation                            â”‚      â”‚
â”‚  â”‚  â€¢ Bonus abuse (táº¡o nhiá»u accounts láº¥y promo)                 â”‚      â”‚
â”‚  â”‚  â€¢ Spam accounts                                              â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â”‚  CÃ¡ch hoáº¡t Ä‘á»™ng:                                              â”‚      â”‚
â”‚  â”‚  1. Analyze signup request patterns                           â”‚      â”‚
â”‚  â”‚  2. Check email/phone reputation                              â”‚      â”‚
â”‚  â”‚  3. Detect automated behavior                                 â”‚      â”‚
â”‚  â”‚  4. CAPTCHA or block suspicious signups                       â”‚      â”‚
â”‚  â”‚                                                                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                          â”‚
â”‚  Cost: $10/month per Web ACL + $1/1000 requests                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Integration vá»›i AWS Services

### Supported Resources

| Service | Region | Notes |
|---------|--------|-------|
| **Amazon CloudFront** | Global (us-east-1) | CDN protection |
| **Application Load Balancer** | Regional | Web app protection |
| **Amazon API Gateway** | Regional | REST API protection |
| **AWS AppSync** | Regional | GraphQL API protection |
| **Amazon Cognito** | Regional | User pool protection |
| **AWS App Runner** | Regional | Container apps |
| **AWS Verified Access** | Regional | Zero trust |

### VÃ­ dá»¥ tÃ­ch há»£p vá»›i CloudFront

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CloudFront + WAF Integration                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚     Users (Worldwide)                                                    â”‚
â”‚           â”‚                                                              â”‚
â”‚           â–¼                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                    CloudFront (Edge)                           â”‚     â”‚
â”‚   â”‚                                                                â”‚     â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚
â”‚   â”‚  â”‚                     AWS WAF                               â”‚ â”‚     â”‚
â”‚   â”‚  â”‚                                                           â”‚ â”‚     â”‚
â”‚   â”‚  â”‚  âœ… Request allowed                                       â”‚ â”‚     â”‚
â”‚   â”‚  â”‚  âŒ Request blocked â†’ Return 403                          â”‚ â”‚     â”‚
â”‚   â”‚  â”‚                                                           â”‚ â”‚     â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚
â”‚   â”‚                                                                â”‚     â”‚
â”‚   â”‚  Cache Hit? â†’ Return cached content                           â”‚     â”‚
â”‚   â”‚  Cache Miss? â†’ Forward to origin                              â”‚     â”‚
â”‚   â”‚                                                                â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚           â”‚                                                              â”‚
â”‚           â–¼                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                      Origin (S3, ALB, EC2)                     â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                          â”‚
â”‚   Lá»£i Ã­ch:                                                               â”‚
â”‚   â€¢ Block táº¡i Edge trÆ°á»›c khi traffic Ä‘áº¿n origin                          â”‚
â”‚   â€¢ Giáº£m load cho origin servers                                         â”‚
â”‚   â€¢ Global protection                                                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## So sÃ¡nh WAF vs Shield vs Firewall Manager

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              WAF vs Shield vs Firewall Manager                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        AWS WAF                                   â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Layer: 7 (Application)                                         â”‚    â”‚
â”‚  â”‚  Protects: Web apps, APIs                                       â”‚    â”‚
â”‚  â”‚  Against: SQL injection, XSS, bots, L7 DDoS                     â”‚    â”‚
â”‚  â”‚  Cost: Pay per rule, request                                    â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                       AWS Shield                                 â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Layer: 3, 4 (Network, Transport)                               â”‚    â”‚
â”‚  â”‚  Protects: All AWS resources                                    â”‚    â”‚
â”‚  â”‚  Against: DDoS attacks (SYN floods, UDP reflection)             â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ Shield Standard â”‚  â”‚ Shield Advanced                     â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                                     â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ FREE          â”‚  â”‚ â€¢ $3,000/month                      â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ Auto-enabled  â”‚  â”‚ â€¢ 24/7 DRT support                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ L3/L4 DDoS    â”‚  â”‚ â€¢ L3/L4/L7 DDoS                     â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚ â€¢ Cost protection                   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚ â€¢ WAF included                      â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                   AWS Firewall Manager                           â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Purpose: Centralized management                                â”‚    â”‚
â”‚  â”‚  Manages: WAF, Shield Advanced, Security Groups, Network FW     â”‚    â”‚
â”‚  â”‚  Scope: Across AWS Organization (multiple accounts)             â”‚    â”‚
â”‚  â”‚  Cost: $100/month per region                                    â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### So sÃ¡nh chi tiáº¿t

| TiÃªu chÃ­ | AWS WAF | Shield Standard | Shield Advanced | Firewall Manager |
|----------|---------|-----------------|-----------------|------------------|
| **Layer** | 7 | 3, 4 | 3, 4, 7 | N/A (management) |
| **DDoS** | L7 only | L3/L4 basic | L3/L4/L7 advanced | N/A |
| **Web exploits** | âœ… | âŒ | âœ… (via WAF) | N/A |
| **Cost** | Pay-per-use | FREE | $3,000/month | $100/region/month |
| **Auto-enabled** | âŒ | âœ… | âŒ | âŒ |
| **Multi-account** | âŒ | âŒ | âœ… | âœ… |
| **DRT Support** | âŒ | âŒ | âœ… 24/7 | âŒ |

### Khi nÃ o dÃ¹ng gÃ¬?

| Scenario | Solution |
|----------|----------|
| Báº£o vá»‡ web app khá»i SQL injection, XSS | **WAF** |
| DDoS protection cÆ¡ báº£n | **Shield Standard** (Ä‘Ã£ cÃ³ sáºµn) |
| Enterprise, high-profile target | **Shield Advanced + WAF** |
| Nhiá»u AWS accounts | **Firewall Manager** |
| VPC network protection | **Network Firewall** (khÃ¡c service) |

---

## Pricing

### AWS WAF Base Pricing

| Component | Cost |
|-----------|------|
| **Web ACL** | $5.00/month |
| **Rule** | $1.00/month per rule |
| **Managed Rule Group** | $1.00/month + vendor fee |
| **Requests** | $0.60/million requests |
| **Extra WCUs** | $0.20/million requests per 500 WCUs |

### Bot Control Pricing

| Level | Free Tier | After Free Tier |
|-------|-----------|-----------------|
| **Common** | 10M requests/month | $1/million requests |
| **Targeted** | 1M requests/month | $10/million requests |

### Fraud Control Pricing

| Component | Cost |
|-----------|------|
| **Subscription** | $10/month per Web ACL |
| **Requests** | ~$1/1,000 requests |
| **Free Tier** | 10,000 requests/month |

### VÃ­ dá»¥ tÃ­nh giÃ¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Monthly Cost Example                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Setup:                                                     â”‚
â”‚  â€¢ 1 Web ACL attached to CloudFront                         â”‚
â”‚  â€¢ 5 custom rules                                           â”‚
â”‚  â€¢ AWS Core Rule Set (managed)                              â”‚
â”‚  â€¢ 10 million requests/month                                â”‚
â”‚                                                             â”‚
â”‚  Calculation:                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  Web ACL:           1 Ã— $5.00     = $5.00                   â”‚
â”‚  Custom Rules:      5 Ã— $1.00     = $5.00                   â”‚
â”‚  Managed Rule:      1 Ã— $1.00     = $1.00                   â”‚
â”‚  Requests:          10M Ã— $0.60/M = $6.00                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  TOTAL:                           = $17.00/month            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ğŸ’¡ **Tip:** Náº¿u dÃ¹ng **Shield Advanced**, WAF base costs (Web ACL, rules, requests) Ä‘Æ°á»£c **miá»…n phÃ­** cho protected resources!

---

## Best Practices

### 1. Start with Managed Rules

```
Recommended setup:
1. AWSManagedRulesCommonRuleSet (Core Rule Set)
2. AWSManagedRulesKnownBadInputsRuleSet
3. AWSManagedRulesAmazonIpReputationList
4. Rate-based rule (2000 requests/5 min)
```

### 2. Use COUNT mode first

```
TrÆ°á»›c khi BLOCK:
1. ThÃªm rule vá»›i action = COUNT
2. Monitor trong 1-2 tuáº§n
3. Review false positives trong WAF logs
4. Adjust rules náº¿u cáº§n
5. Chuyá»ƒn sang BLOCK
```

### 3. Rule Priority Order

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Recommended Order                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Priority 0:    IP Whitelist (ALLOW)                        â”‚
â”‚  Priority 100:  IP Blocklist (BLOCK)                        â”‚
â”‚  Priority 200:  Rate-based rules (BLOCK)                    â”‚
â”‚  Priority 300:  Geo restrictions (BLOCK)                    â”‚
â”‚  Priority 400:  Managed rules (BLOCK)                       â”‚
â”‚  Priority 500:  Custom rules (BLOCK)                        â”‚
â”‚  Default:       ALLOW                                       â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ Sá»‘ priority nhá» = xá»­ lÃ½ trÆ°á»›c                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Logging

- Enable **WAF Logs** â†’ S3, CloudWatch Logs, hoáº·c Kinesis Firehose
- Analyze blocked/counted requests
- Set up CloudWatch alarms for attack detection

---

## Exam Tips

### Key Points for AWS Exams

1. **WAF = Layer 7 protection**
   - SQL injection, XSS, bad bots
   - Attach to CloudFront, ALB, API Gateway

2. **Shield = DDoS protection**
   - Standard = FREE, auto-enabled
   - Advanced = $3,000/month, 24/7 DRT

3. **Firewall Manager = Central management**
   - Across AWS Organization
   - Manages WAF, Shield, Security Groups

4. **WAF Rules**
   - Regular rules = match conditions
   - Rate-based rules = threshold blocking
   - Managed rules = pre-configured, auto-updated

5. **Actions**
   - ALLOW, BLOCK, COUNT
   - CAPTCHA vÃ  Challenge cho bot detection

### Common Exam Scenarios

| Scenario | Answer |
|----------|--------|
| Block SQL injection | **AWS WAF** |
| DDoS protection (free) | **Shield Standard** |
| 24/7 DDoS response team | **Shield Advanced** |
| Centrally manage WAF across accounts | **Firewall Manager** |
| Block IPs exceeding request threshold | **Rate-based rule** |
| Test rules without blocking | **COUNT action** |
| Protect CloudFront from bots | **WAF Bot Control** |
| Block traffic from specific countries | **Geo Match condition** |

---

## LiÃªn káº¿t liÃªn quan

- [CloudFront](./cloudfront.md)
- [API Gateway](./api-gateway.md)
- [ELB](./elb.md)
- [AWS Organizations](./aws-organizations.md) - Firewall Manager
- [Security Groups](./security-groups.md)
