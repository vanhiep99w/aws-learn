# AWS Batch


## Má»¥c lá»¥c

- [Tá»•ng quan](#tá»•ng-quan)
- [ï¸ Kiáº¿n trÃºc AWS Batch](#kiáº¿n-trÃºc-aws-batch)
- [EC2 vs Fargate trong AWS Batch](#ec2-vs-fargate-trong-aws-batch)
- [Job Dependencies](#job-dependencies)
- [Chi phÃ­ AWS Batch](#chi-phÃ­-aws-batch)
- [AWS Batch vs CÃ¡c Services KhÃ¡c](#aws-batch-vs-cÃ¡c-services-khÃ¡c)
- [VÃ­ dá»¥ thá»±c táº¿: Video Processing Pipeline](#vÃ­-dá»¥-thá»±c-táº¿-video-processing-pipeline)
- [ï¸ TÃ­ch há»£p vá»›i cÃ¡c AWS Services](#tÃ­ch-há»£p-vá»›i-cÃ¡c-aws-services)
- [Best Practices](#best-practices)
- [Monitoring vÃ  Debugging](#monitoring-vÃ -debugging)
- [Tá»•ng káº¿t](#tá»•ng-káº¿t)
- [LiÃªn káº¿t](#liÃªn-káº¿t)

---

## ğŸ“– Tá»•ng quan

**AWS Batch** lÃ  dá»‹ch vá»¥ Ä‘Æ°á»£c AWS quáº£n lÃ½ hoÃ n toÃ n Ä‘á»ƒ cháº¡y **batch computing workloads** á»Ÿ báº¥t ká»³ quy mÃ´ nÃ o. AWS Batch tá»± Ä‘á»™ng cung cáº¥p compute resources vÃ  tá»‘i Æ°u hÃ³a viá»‡c phÃ¢n phá»‘i workload dá»±a trÃªn sá»‘ lÆ°á»£ng vÃ  yÃªu cáº§u resources cá»§a jobs.

### Batch Computing lÃ  gÃ¬?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REAL-TIME vs BATCH PROCESSING                     â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚  â”‚      REAL-TIME PROCESSING       â”‚                                 â”‚
â”‚  â”‚                                 â”‚                                 â”‚
â”‚  â”‚   Request â†’ Process â†’ Response  â”‚                                 â”‚
â”‚  â”‚      â†“         â†“         â†“      â”‚                                 â”‚
â”‚  â”‚   User     Ngay láº­p   User      â”‚                                 â”‚
â”‚  â”‚   gá»­i      tá»©c xá»­ lÃ½   nháº­n     â”‚                                 â”‚    
â”‚  â”‚                                 â”‚                                 â”‚
â”‚  â”‚   VÃ­ dá»¥: Web API, Chat app      â”‚                                 â”‚
â”‚  â”‚   Latency: milliseconds         â”‚                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚  â”‚       BATCH PROCESSING          â”‚                                 â”‚
â”‚  â”‚                                 â”‚                                 â”‚
â”‚  â”‚   Jobs â†’ Queue â†’ Process        â”‚                                 â”‚
â”‚  â”‚    â†“       â†“        â†“           â”‚                                 â”‚
â”‚  â”‚  Collect  Wait   Process        â”‚                                 â”‚
â”‚  â”‚  nhiá»u   Ä‘áº¿n     táº¥t cáº£         â”‚                                 â”‚
â”‚  â”‚  jobs    lÆ°á»£t    cÃ¹ng lÃºc       â”‚                                 â”‚
â”‚  â”‚                                 â”‚                                 â”‚
â”‚  â”‚   VÃ­ dá»¥: Video encoding,        â”‚                                 â”‚
â”‚  â”‚          Data analysis,         â”‚                                 â”‚
â”‚  â”‚          ML training            â”‚                                 â”‚
â”‚  â”‚   Duration: minutes â†’ hours     â”‚                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Táº¡i sao cáº§n AWS Batch?

| Tá»± quáº£n lÃ½ Batch Jobs | AWS Batch |
|----------------------|-----------|
| Tá»± setup job queue system | Built-in job queues |
| Tá»± provision EC2/containers | Tá»± Ä‘á»™ng provision |
| Tá»± scale compute resources | Auto-scaling tÃ­ch há»£p |
| Tá»± quáº£n lÃ½ job dependencies | Dependency management |
| Tá»± retry failed jobs | Automatic retries |
| Tá»± tá»‘i Æ°u resource usage | Optimal resource allocation |

### Use Cases phá»• biáº¿n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AWS BATCH USE CASES                             â”‚
â”‚                                                                       â”‚
â”‚  1. ğŸ¬ MEDIA PROCESSING                                              â”‚
â”‚     â”œâ”€â”€ Video transcoding (1000s videos cÃ¹ng lÃºc)                   â”‚
â”‚     â”œâ”€â”€ Image processing pipelines                                   â”‚
â”‚     â””â”€â”€ Audio normalization                                          â”‚
â”‚                                                                       â”‚
â”‚  2. ğŸ§¬ SCIENTIFIC COMPUTING                                          â”‚
â”‚     â”œâ”€â”€ Genomics data analysis                                       â”‚
â”‚     â”œâ”€â”€ Drug discovery simulations                                   â”‚
â”‚     â””â”€â”€ Climate modeling                                             â”‚
â”‚                                                                       â”‚
â”‚  3. ğŸ¤– MACHINE LEARNING                                              â”‚
â”‚     â”œâ”€â”€ Model training (Ä‘áº·c biá»‡t vá»›i GPU)                           â”‚
â”‚     â”œâ”€â”€ Hyperparameter tuning                                        â”‚
â”‚     â””â”€â”€ Batch inference                                              â”‚
â”‚                                                                       â”‚
â”‚  4. ğŸ“Š DATA PROCESSING                                               â”‚
â”‚     â”œâ”€â”€ ETL jobs (Extract, Transform, Load)                         â”‚
â”‚     â”œâ”€â”€ Log processing                                               â”‚
â”‚     â””â”€â”€ Financial simulations                                        â”‚
â”‚                                                                       â”‚
â”‚  5. ğŸ—ï¸ RENDERING                                                     â”‚
â”‚     â”œâ”€â”€ 3D rendering (Animation studios)                            â”‚
â”‚     â”œâ”€â”€ VFX processing                                               â”‚
â”‚     â””â”€â”€ Architectural visualization                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ Kiáº¿n trÃºc AWS Batch

### CÃ¡c thÃ nh pháº§n chÃ­nh

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AWS BATCH ARCHITECTURE                           â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                     â”‚
â”‚  â”‚   Submit    â”‚ â”€â”€â†’ Job Definition (blueprint)                      â”‚
â”‚  â”‚    Job      â”‚                                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      JOB QUEUE                               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚  â”‚ Job 1 â”‚ â”‚ Job 2 â”‚ â”‚ Job 3 â”‚ â”‚ Job 4 â”‚ â”‚ Job 5 â”‚          â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                  AWS BATCH SCHEDULER                         â”‚    â”‚
â”‚  â”‚         (Evaluates when, where, how to run jobs)            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚               COMPUTE ENVIRONMENT                            â”‚    â”‚
â”‚  â”‚                                                               â”‚    â”‚
â”‚  â”‚   EC2 Instances hoáº·c Fargate                                 â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚    â”‚
â”‚  â”‚   â”‚ Job 1   â”‚ â”‚ Job 2   â”‚ â”‚ Job 3   â”‚                        â”‚    â”‚
â”‚  â”‚   â”‚ Running â”‚ â”‚ Running â”‚ â”‚ Running â”‚                        â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ“Œ 1. Job Definition

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        JOB DEFINITION                                â”‚
â”‚                                                                       â”‚
â”‚   = BLUEPRINT / Template cho jobs                                    â”‚
â”‚   = TÆ°Æ¡ng tá»± Task Definition trong ECS                               â”‚
â”‚                                                                       â”‚
â”‚   Äá»‹nh nghÄ©a:                                                        â”‚
â”‚   â”œâ”€â”€ Container image (Docker image)                                â”‚
â”‚   â”œâ”€â”€ vCPU vÃ  Memory requirements                                   â”‚
â”‚   â”œâ”€â”€ Job role (IAM permissions)                                    â”‚
â”‚   â”œâ”€â”€ Environment variables                                          â”‚
â”‚   â”œâ”€â”€ Mount points vÃ  volumes                                        â”‚
â”‚   â”œâ”€â”€ Retry strategy                                                 â”‚
â”‚   â”œâ”€â”€ Timeout settings                                               â”‚
â”‚   â””â”€â”€ Platform (EC2 hoáº·c Fargate)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**VÃ­ dá»¥ Job Definition:**

```json
{
  "jobDefinitionName": "video-transcode-job",
  "type": "container",
  "platformCapabilities": ["FARGATE"],
  "containerProperties": {
    "image": "my-registry/video-encoder:latest",
    "resourceRequirements": [
      { "type": "VCPU", "value": "4" },
      { "type": "MEMORY", "value": "8192" }
    ],
    "jobRoleArn": "arn:aws:iam::123456789:role/BatchJobRole",
    "executionRoleArn": "arn:aws:iam::123456789:role/ecsTaskExecutionRole",
    "environment": [
      { "name": "OUTPUT_BUCKET", "value": "my-output-bucket" }
    ],
    "command": ["python", "transcode.py", "Ref::inputFile"]
  },
  "retryStrategy": {
    "attempts": 3
  },
  "timeout": {
    "attemptDurationSeconds": 3600
  }
}
```

---

### ğŸ“Œ 2. Job

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              JOB                                     â”‚
â”‚                                                                       â”‚
â”‚   = Instance cá»§a Job Definition Ä‘ang cháº¡y                            â”‚
â”‚   = Má»™t unit of work Ä‘Æ°á»£c submit                                     â”‚
â”‚                                                                       â”‚
â”‚   Job States:                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚ SUBMITTEDâ”‚ â†’ â”‚ PENDING  â”‚ â†’ â”‚ RUNNABLE â”‚ â†’ â”‚ STARTING â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                       â”‚              â”‚
â”‚                                                       â–¼              â”‚
â”‚                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚                                               â”‚ RUNNING  â”‚          â”‚
â”‚                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                    â”‚                 â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                                    â–¼               â–¼               â–¼â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              â”‚SUCCEEDED â”‚   â”‚  FAILED  â”‚   â”‚  TIMED   â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   OUT   â”‚
â”‚                                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CÃ¡c loáº¡i Jobs:**

| Loáº¡i | MÃ´ táº£ |
|------|-------|
| **Single Job** | 1 job = 1 container |
| **Array Job** | 1 job definition â†’ N jobs song song (batch) |
| **Multi-node Job** | Job cháº¡y trÃªn nhiá»u nodes (HPC, ML training) |

**Array Job Example:**

```bash
# Submit array job vá»›i 1000 tasks
aws batch submit-job \
  --job-name "process-images" \
  --job-queue "high-priority" \
  --job-definition "image-processor" \
  --array-properties size=1000
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ARRAY JOB                                    â”‚
â”‚                                                                       â”‚
â”‚   1 Job Definition â†’ 1000 Jobs song song                            â”‚
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚ Job[0]  â”‚ â”‚ Job[1]  â”‚ â”‚ Job[2]  â”‚  ...    â”‚Job[999] â”‚           â”‚
â”‚   â”‚image-0  â”‚ â”‚image-1  â”‚ â”‚image-2  â”‚         â”‚image-999â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                       â”‚
â”‚   Má»—i job nháº­n AWS_BATCH_JOB_ARRAY_INDEX env variable               â”‚
â”‚   Ä‘á»ƒ biáº¿t mÃ¬nh xá»­ lÃ½ item nÃ o                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ“Œ 3. Job Queue

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          JOB QUEUE                                   â”‚
â”‚                                                                       â”‚
â”‚   = HÃ ng Ä‘á»£i chá»©a jobs chá» Ä‘Æ°á»£c xá»­ lÃ½                                â”‚
â”‚   = Káº¿t ná»‘i vá»›i 1 hoáº·c nhiá»u Compute Environments                    â”‚
â”‚                                                                       â”‚
â”‚   Features:                                                          â”‚
â”‚   â”œâ”€â”€ Priority: Queues cÃ³ priority khÃ¡c nhau                        â”‚
â”‚   â”œâ”€â”€ Scheduling: FIFO trong cÃ¹ng priority                          â”‚
â”‚   â”œâ”€â”€ State: ENABLED / DISABLED                                      â”‚
â”‚   â””â”€â”€ Fallback: Náº¿u CE 1 Ä‘áº§y â†’ chuyá»ƒn sang CE 2                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Multi-Queue vá»›i Priority:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRIORITY QUEUE SYSTEM                             â”‚
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Priority: 100 (CAO NHáº¤T)         â”‚
â”‚   â”‚    HIGH PRIORITY QUEUE      â”‚  â†’ Production jobs                 â”‚
â”‚   â”‚    â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”     â”‚                                    â”‚
â”‚   â”‚    â”‚Job1â”‚ â”‚Job2â”‚ â”‚Job3â”‚     â”‚  â† ÄÆ°á»£c xá»­ lÃ½ TRÆ¯á»šC               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Priority: 50                      â”‚
â”‚   â”‚    MEDIUM PRIORITY QUEUE    â”‚  â†’ Development jobs                â”‚
â”‚   â”‚    â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”            â”‚                                    â”‚
â”‚   â”‚    â”‚Job4â”‚ â”‚Job5â”‚            â”‚  â† Xá»­ lÃ½ SAU high priority        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Priority: 10 (THáº¤P NHáº¤T)         â”‚
â”‚   â”‚     LOW PRIORITY QUEUE      â”‚  â†’ Batch reports                   â”‚
â”‚   â”‚    â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”     â”‚                                    â”‚
â”‚   â”‚    â”‚    â”‚ â”‚    â”‚ â”‚    â”‚     â”‚  â† Xá»­ lÃ½ cuá»‘i cÃ¹ng                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ“Œ 4. Compute Environment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    COMPUTE ENVIRONMENT                               â”‚
â”‚                                                                       â”‚
â”‚   = Compute resources Ä‘á»ƒ cháº¡y jobs                                   â”‚
â”‚   = TÆ°Æ¡ng tá»± ECS Cluster                                             â”‚
â”‚                                                                       â”‚
â”‚   2 LOáº I CHÃNH:                                                      â”‚
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚    MANAGED (AWS quáº£n lÃ½) â”‚  â”‚  UNMANAGED (Báº¡n quáº£n lÃ½)  â”‚      â”‚
â”‚   â”‚                           â”‚  â”‚                           â”‚      â”‚
â”‚   â”‚  AWS tá»± Ä‘á»™ng:             â”‚  â”‚  Báº¡n pháº£i:                â”‚      â”‚
â”‚   â”‚  - Provision EC2/Fargate  â”‚  â”‚  - Tá»± táº¡o ECS cluster     â”‚      â”‚
â”‚   â”‚  - Scale lÃªn/xuá»‘ng        â”‚  â”‚  - Tá»± scale instances     â”‚      â”‚
â”‚   â”‚  - Patch instances        â”‚  â”‚  - Tá»± manage lifecycle    â”‚      â”‚
â”‚   â”‚                           â”‚  â”‚                           â”‚      â”‚
â”‚   â”‚  âœ… Recommended           â”‚  â”‚  âš ï¸ Advanced use cases    â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Managed Compute Environment - EC2:**

```json
{
  "computeEnvironmentName": "my-batch-ce",
  "type": "MANAGED",
  "state": "ENABLED",
  "computeResources": {
    "type": "EC2",
    "allocationStrategy": "BEST_FIT_PROGRESSIVE",
    "minvCpus": 0,
    "maxvCpus": 256,
    "desiredvCpus": 0,
    "instanceTypes": ["optimal"],
    "subnets": ["subnet-xxx", "subnet-yyy"],
    "securityGroupIds": ["sg-xxx"],
    "instanceRole": "arn:aws:iam::123456789:instance-profile/ecsInstanceRole"
  }
}
```

**Managed Compute Environment - Fargate:**

```json
{
  "computeEnvironmentName": "my-fargate-ce",
  "type": "MANAGED",
  "state": "ENABLED",
  "computeResources": {
    "type": "FARGATE",
    "maxvCpus": 256,
    "subnets": ["subnet-xxx", "subnet-yyy"],
    "securityGroupIds": ["sg-xxx"]
  }
}
```

---

## ğŸš€ EC2 vs Fargate trong AWS Batch

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EC2 vs FARGATE for BATCH                          â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           EC2                â”‚  â”‚          FARGATE              â”‚ â”‚
â”‚  â”‚                              â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  âœ… GPU support              â”‚  â”‚  âœ… Serverless, no servers   â”‚ â”‚
â”‚  â”‚  âœ… Spot instances (ráº»)     â”‚  â”‚  âœ… Faster startup            â”‚ â”‚
â”‚  â”‚  âœ… Custom AMIs              â”‚  â”‚  âœ… Simple pricing            â”‚ â”‚
â”‚  â”‚  âœ… Large instance types     â”‚  â”‚  âœ… No capacity planning     â”‚ â”‚
â”‚  â”‚                              â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  âŒ Slower cold start       â”‚  â”‚  âŒ No GPU support            â”‚ â”‚
â”‚  â”‚  âŒ More config needed      â”‚  â”‚  âŒ Max 4 vCPU, 30GB RAM     â”‚ â”‚
â”‚  â”‚                              â”‚  â”‚  âŒ No Spot pricing          â”‚ â”‚
â”‚  â”‚                              â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  Best for:                   â”‚  â”‚  Best for:                   â”‚ â”‚
â”‚  â”‚  - GPU workloads            â”‚  â”‚  - Quick, small jobs         â”‚ â”‚
â”‚  â”‚  - Large memory jobs        â”‚  â”‚  - Variable workloads        â”‚ â”‚
â”‚  â”‚  - Cost optimization (Spot) â”‚  â”‚  - Simple batch processing   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### EC2 Allocation Strategies

| Strategy | MÃ´ táº£ | Use Case |
|----------|-------|----------|
| **BEST_FIT** | Chá»n instance ráº» nháº¥t Ä‘á»§ resources | Cost optimization |
| **BEST_FIT_PROGRESSIVE** | BEST_FIT + thÃªm instance types | Balance cost & availability |
| **SPOT_CAPACITY_OPTIMIZED** | Chá»n Spot Ã­t bá»‹ interrupt nháº¥t | Long-running jobs |

---

## ğŸ”— Job Dependencies

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      JOB DEPENDENCIES                                â”‚
â”‚                                                                       â”‚
â”‚   AWS Batch há»— trá»£ cháº¡y jobs theo thá»© tá»± dependencies               â”‚
â”‚                                                                       â”‚
â”‚   VÃ­ dá»¥: ETL Pipeline                                                â”‚
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚   â”‚   Extract   â”‚ Job A: Download data tá»« S3                        â”‚
â”‚   â”‚   Job A     â”‚                                                    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚          â”‚ depends on                                                â”‚
â”‚          â–¼                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚   â”‚  Transform  â”‚ Job B: Process vÃ  transform data                  â”‚
â”‚   â”‚   Job B     â”‚                                                    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚          â”‚ depends on                                                â”‚
â”‚          â–¼                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚   â”‚    Load     â”‚ Job C: Load vÃ o database                          â”‚
â”‚   â”‚   Job C     â”‚                                                    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Dependency Types:**

```python
# Sequential dependency
aws batch submit-job \
  --job-name "transform-job" \
  --job-queue "my-queue" \
  --job-definition "transform-def" \
  --depends-on jobId=extract-job-id

# N_TO_N: Array job phá»¥ thuá»™c vÃ o array job khÃ¡c
# Má»—i child trong array B Ä‘á»£i corresponding child trong array A
aws batch submit-job \
  --job-name "process-array" \
  --depends-on jobId=download-array-id,type=N_TO_N
```

---

## ğŸ’° Chi phÃ­ AWS Batch

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AWS BATCH PRICING                             â”‚
â”‚                                                                       â”‚
â”‚   AWS Batch = FREE! ğŸ‰                                               â”‚
â”‚                                                                       â”‚
â”‚   Báº¡n chá»‰ tráº£ tiá»n cho:                                              â”‚
â”‚   â”œâ”€â”€ EC2 instances (hoáº·c Fargate)                                  â”‚
â”‚   â”œâ”€â”€ Data transfer                                                  â”‚
â”‚   â””â”€â”€ CÃ¡c AWS services khÃ¡c (S3, ECR, etc.)                         â”‚
â”‚                                                                       â”‚
â”‚   TIáº¾T KIá»†M CHI PHÃ:                                                 â”‚
â”‚                                                                       â”‚
â”‚   1. DÃ¹ng SPOT INSTANCES (tiáº¿t kiá»‡m Ä‘áº¿n 90%)                        â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚      â”‚  On-Demand: $0.096/hour              â”‚                        â”‚
â”‚      â”‚  Spot:      $0.029/hour (70% off!)   â”‚                        â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                       â”‚
â”‚   2. Set minvCpus = 0 (scale to zero khi idle)                      â”‚
â”‚                                                                       â”‚
â”‚   3. Right-size job resources                                        â”‚
â”‚      Äá»«ng request 8 vCPU náº¿u chá»‰ cáº§n 2 vCPU                         â”‚
â”‚                                                                       â”‚
â”‚   4. DÃ¹ng Savings Plans cho predictable workloads                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ AWS Batch vs CÃ¡c Services KhÃ¡c

### AWS Batch vs Lambda

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AWS BATCH vs LAMBDA                               â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         AWS BATCH            â”‚  â”‚          LAMBDA              â”‚ â”‚
â”‚  â”‚                              â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  Duration: Minutes â†’ Hours   â”‚  â”‚  Duration: Max 15 minutes   â”‚ â”‚
â”‚  â”‚  Memory: Up to TBs          â”‚  â”‚  Memory: Max 10 GB           â”‚ â”‚
â”‚  â”‚  CPU: Up to 100s vCPUs      â”‚  â”‚  CPU: Max 6 vCPUs            â”‚ â”‚
â”‚  â”‚  GPU: âœ… Yes                 â”‚  â”‚  GPU: âŒ No                  â”‚ â”‚
â”‚  â”‚  Custom runtime: âœ… Docker   â”‚  â”‚  Custom: Limited runtimes   â”‚ â”‚
â”‚  â”‚  Cold start: Slower         â”‚  â”‚  Cold start: Faster          â”‚ â”‚
â”‚  â”‚                              â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  Best for:                   â”‚  â”‚  Best for:                   â”‚ â”‚
â”‚  â”‚  - Long-running jobs        â”‚  â”‚  - Quick tasks (<15 min)     â”‚ â”‚
â”‚  â”‚  - Batch processing         â”‚  â”‚  - Event-driven              â”‚ â”‚
â”‚  â”‚  - HPC, ML training         â”‚  â”‚  - API backends              â”‚ â”‚
â”‚  â”‚  - GPU workloads            â”‚  â”‚  - Real-time processing      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AWS Batch vs ECS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AWS BATCH vs ECS                                 â”‚
â”‚                                                                       â”‚
â”‚  AWS Batch = Built ON TOP of ECS                                     â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                       AWS BATCH                               â”‚   â”‚
â”‚  â”‚   + Job queuing                                               â”‚   â”‚
â”‚  â”‚   + Job scheduling                                            â”‚   â”‚
â”‚  â”‚   + Automatic scaling based on job queue                      â”‚   â”‚
â”‚  â”‚   + Job dependencies                                          â”‚   â”‚
â”‚  â”‚   + Retry policies                                            â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚   â”‚                     ECS                               â”‚   â”‚   â”‚
â”‚  â”‚   â”‚   Container orchestration                             â”‚   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â”‚  Chá»n ECS khi:                  Chá»n Batch khi:                      â”‚
â”‚  - Long-running services        - Batch/job workloads                â”‚
â”‚  - Web APIs, microservices      - Scheduled processing               â”‚
â”‚  - Always-on applications       - Run-to-completion jobs             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### So sÃ¡nh tá»•ng quan

| Feature | Lambda | AWS Batch | ECS/Fargate |
|---------|--------|-----------|-------------|
| **Use case** | Event-driven | Batch jobs | Long-running services |
| **Duration** | Max 15 min | Hours/Days | Continuous |
| **Scaling** | Per request | Per job queue | Per service |
| **GPU** | âŒ | âœ… | âœ… |
| **Custom runtime** | Limited | Docker | Docker |
| **Management** | Serverless | Managed | Managed |
| **Pricing** | Per invocation | Per compute | Per compute |

---

## ğŸ¯ VÃ­ dá»¥ thá»±c táº¿: Video Processing Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              VIDEO PROCESSING PIPELINE vá»›i AWS BATCH                 â”‚
â”‚                                                                       â”‚
â”‚   User uploads video â†’ S3 â†’ Lambda â†’ AWS Batch Jobs                 â”‚
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  User  â”‚ â†’ â”‚   S3   â”‚ â†’ â”‚         EventBridge              â”‚   â”‚
â”‚   â”‚        â”‚    â”‚(Upload)â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                        â”‚
â”‚                                              â–¼                        â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                               â”‚      Submit to AWS Batch        â”‚   â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                              â”‚                        â”‚
â”‚                                              â–¼                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      JOB QUEUE                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                              â”‚                        â”‚
â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚             â–¼                                â–¼                â–¼      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚ Job 1: Extract  â”‚            â”‚ Job 2: Transcodeâ”‚ â”‚Job 3: Uploadâ”‚â”‚
â”‚   â”‚ - Download      â”‚ depends â†’  â”‚ - 1080p         â”‚ â”‚ - S3 output â”‚â”‚
â”‚   â”‚ - Validate      â”‚            â”‚ - 720p          â”‚ â”‚ - Notify    â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ - 480p          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                       â”‚
â”‚   Compute Environment: EC2 vá»›i GPU instances (g4dn.xlarge)          â”‚
â”‚   Spot Instances Ä‘á»ƒ tiáº¿t kiá»‡m 70% chi phÃ­                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Job Definition cho Video Transcode:**

```json
{
  "jobDefinitionName": "video-transcode",
  "type": "container",
  "platformCapabilities": ["EC2"],
  "containerProperties": {
    "image": "123456789.dkr.ecr.us-east-1.amazonaws.com/ffmpeg:latest",
    "resourceRequirements": [
      { "type": "GPU", "value": "1" },
      { "type": "VCPU", "value": "4" },
      { "type": "MEMORY", "value": "16384" }
    ],
    "command": [
      "ffmpeg", "-i", "Ref::inputFile",
      "-c:v", "h264_nvenc",
      "-preset", "fast",
      "Ref::outputFile"
    ],
    "environment": [
      { "name": "OUTPUT_BUCKET", "value": "processed-videos" }
    ],
    "mountPoints": [
      {
        "containerPath": "/data",
        "sourceVolume": "data-volume"
      }
    ],
    "volumes": [
      {
        "name": "data-volume",
        "host": { "sourcePath": "/tmp/data" }
      }
    ]
  },
  "retryStrategy": { "attempts": 3 },
  "timeout": { "attemptDurationSeconds": 7200 }
}
```

---

## ğŸ› ï¸ TÃ­ch há»£p vá»›i cÃ¡c AWS Services

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  AWS BATCH INTEGRATIONS                              â”‚
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Submit jobs                                     â”‚
â”‚   â”‚  EventBridge  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚   â”‚  (Scheduler)  â”‚                   â”‚                              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â–¼                              â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚               â”‚                      â”‚
â”‚   â”‚  Step         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   AWS BATCH   â”‚                      â”‚
â”‚   â”‚  Functions    â”‚           â”‚               â”‚                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                       â”‚                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚ Jobs read/write             â”‚
â”‚   â”‚    Lambda     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚                              â”‚
â”‚   â”‚  (Trigger)    â”‚                   â–¼                              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                               â”‚     S3        â”‚                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   (Data)      â”‚                      â”‚
â”‚   â”‚     ECR       â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚                      â”‚
â”‚   â”‚ (Container    â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚   â”‚  Images)      â”‚                                                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                               â”‚  CloudWatch   â”‚                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  (Logs &      â”‚                      â”‚
â”‚   â”‚   Secrets     â”‚           â”‚   Metrics)    â”‚                      â”‚
â”‚   â”‚   Manager     â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step Functions Integration

```json
{
  "Comment": "ML Training Pipeline",
  "StartAt": "PrepareData",
  "States": {
    "PrepareData": {
      "Type": "Task",
      "Resource": "arn:aws:states:::batch:submitJob.sync",
      "Parameters": {
        "JobName": "prepare-data",
        "JobDefinition": "data-prep-job",
        "JobQueue": "ml-queue"
      },
      "Next": "TrainModel"
    },
    "TrainModel": {
      "Type": "Task",
      "Resource": "arn:aws:states:::batch:submitJob.sync",
      "Parameters": {
        "JobName": "train-model",
        "JobDefinition": "ml-training-job",
        "JobQueue": "gpu-queue"
      },
      "End": true
    }
  }
}
```

---

## ğŸ“‹ Best Practices

### 1. Compute Environment

```
âœ… DO:
â”œâ”€â”€ Set minvCpus = 0 Ä‘á»ƒ scale to zero
â”œâ”€â”€ DÃ¹ng SPOT instances cho fault-tolerant jobs
â”œâ”€â”€ DÃ¹ng "optimal" instance type Ä‘á»ƒ AWS chá»n tá»‘t nháº¥t
â””â”€â”€ TÃ¡ch Compute Environments theo workload type (GPU vs CPU)

âŒ DON'T:
â”œâ”€â”€ Äá»«ng set minvCpus cao náº¿u khÃ´ng cáº§n
â”œâ”€â”€ Äá»«ng dÃ¹ng single instance type
â””â”€â”€ Äá»«ng dÃ¹ng On-Demand cho táº¥t cáº£ jobs
```

### 2. Job Design

```
âœ… DO:
â”œâ”€â”€ Design jobs idempotent (cÃ³ thá»ƒ retry an toÃ n)
â”œâ”€â”€ Checkpoint progress cho long-running jobs
â”œâ”€â”€ Log chi tiáº¿t Ä‘á»ƒ debug
â””â”€â”€ Set reasonable timeouts

âŒ DON'T:
â”œâ”€â”€ Äá»«ng hardcode credentials trong container
â”œâ”€â”€ Äá»«ng ignore retry logic
â””â”€â”€ Äá»«ng request quÃ¡ nhiá»u resources
```

### 3. Cost Optimization

```
1. SPOT INSTANCES
   - Tiáº¿t kiá»‡m 70-90%
   - DÃ¹ng cho fault-tolerant jobs
   - Set SPOT_CAPACITY_OPTIMIZED allocation strategy

2. RIGHT-SIZING
   - Monitor actual resource usage
   - Chá»‰ request resources thá»±c sá»± cáº§n

3. SCALE TO ZERO
   - minvCpus = 0
   - KhÃ´ng tráº£ tiá»n khi khÃ´ng cÃ³ jobs

4. FARGATE SPOT
   - Fargate + Spot pricing
   - Tiáº¿t kiá»‡m Ä‘áº¿n 70% so vá»›i Fargate On-Demand
```

---

## ğŸ” Monitoring vÃ  Debugging

### CloudWatch Metrics

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLOUDWATCH METRICS                                â”‚
â”‚                                                                       â”‚
â”‚   Job Queue Metrics:                                                 â”‚
â”‚   â”œâ”€â”€ JobsSubmitted                                                  â”‚
â”‚   â”œâ”€â”€ JobsPending                                                    â”‚
â”‚   â”œâ”€â”€ JobsRunning                                                    â”‚
â”‚   â”œâ”€â”€ JobsSucceeded                                                  â”‚
â”‚   â””â”€â”€ JobsFailed                                                     â”‚
â”‚                                                                       â”‚
â”‚   Compute Environment Metrics:                                       â”‚
â”‚   â”œâ”€â”€ DesiredvCpus                                                   â”‚
â”‚   â”œâ”€â”€ ActualvCpus                                                    â”‚
â”‚   â””â”€â”€ RunningJobs                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CloudWatch Logs

```python
# Job definition vá»›i logging
{
  "containerProperties": {
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "/aws/batch/job",
        "awslogs-region": "us-east-1",
        "awslogs-stream-prefix": "batch"
      }
    }
  }
}
```

---

## ğŸ“š Tá»•ng káº¿t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AWS BATCH SUMMARY                                â”‚
â”‚                                                                       â”‚
â”‚   WHAT: Managed batch computing service                              â”‚
â”‚                                                                       â”‚
â”‚   COMPONENTS:                                                        â”‚
â”‚   â”œâ”€â”€ Job Definition: Blueprint cho jobs                            â”‚
â”‚   â”œâ”€â”€ Job: Unit of work thá»±c thi                                    â”‚
â”‚   â”œâ”€â”€ Job Queue: HÃ ng Ä‘á»£i vá»›i priority                              â”‚
â”‚   â””â”€â”€ Compute Environment: EC2 hoáº·c Fargate                         â”‚
â”‚                                                                       â”‚
â”‚   WHEN TO USE:                                                       â”‚
â”‚   â”œâ”€â”€ Long-running batch jobs (>15 minutes)                         â”‚
â”‚   â”œâ”€â”€ GPU workloads (ML training, video encoding)                   â”‚
â”‚   â”œâ”€â”€ Massively parallel processing                                  â”‚
â”‚   â””â”€â”€ Scheduled data processing                                      â”‚
â”‚                                                                       â”‚
â”‚   KEY FEATURES:                                                      â”‚
â”‚   â”œâ”€â”€ Auto-scaling compute resources                                â”‚
â”‚   â”œâ”€â”€ Job dependencies vÃ  orchestration                             â”‚
â”‚   â”œâ”€â”€ Spot instance support (cost savings)                          â”‚
â”‚   â”œâ”€â”€ Fair share scheduling                                          â”‚
â”‚   â””â”€â”€ Integration vá»›i Step Functions, EventBridge                   â”‚
â”‚                                                                       â”‚
â”‚   PRICING: Free! Chá»‰ tráº£ cho underlying compute (EC2/Fargate)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— LiÃªn káº¿t

- [â† Lambda](lambda.md) - Serverless functions (jobs < 15 phÃºt)
- [â†’ ECS](ecs.md) - Long-running container services
- [â†’ Step Functions](step-functions.md) - Orchestrate Batch jobs

---

*Cáº­p nháº­t: ThÃ¡ng 1, 2026*
